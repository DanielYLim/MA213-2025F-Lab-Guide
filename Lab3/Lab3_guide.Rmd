---
title: "MA213 Basic Statistics and Probability - Lab3 Guide"
bibliography: references.bib
link-citations: true
output:
  pdf_document: default
  html_document:
    code_download: true 
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
```

## **Lab 3: Plotting and Summaries**

------------------------------------------------------------------------

## Learning Objectives

-   Classify and Analyze Variables: Categorize variables based on their types (e.g., numerical/categorical, continuous/discrete, ordinal), assess their association (positive, negative, or independent), and determine which make sense as explanatory vs. response variables.
-   Use R for Data Management and Exploration: Utilize R to load, pre-process, and explore data through visualization and summarization techniques.

------------------------------------------------------------------------

### Graphics with `ggplot2` package

Plotting with `ggplot2` package begins with

`ggplot(data = df, aes(x=x_xvariable, y=y_variable))`

where

`df` : your dataframe name,

`aes()` : Aesthetics to define -\> specifying which variables are mapped to the x and y axes.

and then you add `geoms` functions â€“ geometrical objects as a graphical representation of the data in the plot (points, lines, bars). **`ggplot2`** offers many different geoms; We will use a few common ones today, including:

-   `geom_point()` : scatter plots, dot plots, etc.

-   `geom_line()` : trend lines, time-series, etc.

-   `geom_histogram()` : histograms

In short,

[![ggplot function overview (\<https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf\> )](ggplot.jpg)](https://github.com/rstudio/cheatsheets/blob/main/data-visualization.pdf)

# Plots to show **New York Air Quality Data**

We want to examine the shape of `Ozone` to see whether the data is symmetric, skewed or how the mean is centered and where...? Let's see how this `Ozone` data is shaped by using several different methods.

## Import the Data

```{r, echo=TRUE}
df = read.csv("airquality.csv")
```

## 1. Summary of `Ozone`.

```{r, echo=TRUE}

summary(df$Ozone)
```

## 2. Stacked dot plot of `Ozone` .

```{r, echo=TRUE}
ggplot(data = df, aes(Ozone)) + 
  geom_dotplot(binwidth = 5) # bins of width 5

```

## 3. Box plot of `Ozone`.

```{r, echo=TRUE}
ggplot(data=df, aes(Ozone)) +
  geom_boxplot()

```

This shows that there are two suspected outliers.

## 4. Histogram of `Ozone` .

```{r, echo=TRUE}
# ggplot version

ggplot(data=df ) + 
  geom_histogram(mapping=aes(Ozone), binwidth = 5) 
  

```

## 5. Histogram with different bin option

by choosing how many observations in each bin (e.g. `bins=5` means each bin contains 5 observations).

```{r, echo=TRUE}


# bins = 5
ggplot(data=df ) + geom_histogram(aes(Ozone), bins = 5)

# bins = 30
ggplot(data=df, aes(Ozone)) + 
  geom_histogram(bins = 30) 


```

## 6. Labels in ggplot

With `labs(x='x lable', y='y lable', title = 'name for your plot')` you can name your plot.

```{r, echo=TRUE}



ggplot(data=df, aes(Ozone)) + 
  geom_histogram(bins = 30, color='yellow') +
  labs(x='Ozone Level', y='Count', title = 'Histogram with 30 bins')


```

## 7. Scatter plot of `Ozone` and `Temp` .

### We want to examine whether there is a relationship between ozone and temperature (both numerical). How do we want to approach this?

```{r, echo=TRUE}

ggplot(df) + geom_point(aes(x=Ozone, y=Temp)) + 
  labs(title='Scatter plot of Ozone vs Temperature')


```

# Titanic Data

We are going to work with titanic data `titanic.csv`. Let's import the data.

```{r, echo=TRUE}
# loading from csv file
df <- read.csv("titanic.csv")
glimpse(df)


```

## 8. Barplot for `Survived`

```{r, echo=TRUE}

new_df <- df %>% count(Survived)
ggplot(new_df, aes(x = Survived, y=n)) +
  geom_col() 


```

## 9. Barplot of `Survived` and `Class`

This shows summary table of `Survived` and `Class`

```{r, echo=TRUE}

df %>% 
  group_by(Survived, Class) %>%
  summarise(count=n()) 

```

Adding `ggplot()` will turn it into barplot using `geom_col()`

```{r, echo=TRUE}

df %>% 
  group_by(Survived, Class) %>%
  summarise(count=n()) %>%
  ggplot(aes(x = factor(Survived), y=count, fill=factor(Class))) +
  geom_col(position = "fill") +  # position can be changed to "dodge", "stack", "jitter", "fill"
  labs(x="Survived")

# for positioning in geom functions
# https://ggplot2.tidyverse.org/reference/layer_positions.html


```

## 10. Pie chart of `Class`

We need `table` class data first in order to show a pie chart

```{r, echo=TRUE}


# dplyr + ggplot

table_data <- df %>% 
  count(Class) %>%
  mutate(Class = factor(Class))

table_data

# alternate way using group_by() + summarise()

table_data2 <- df %>% 
  group_by(Class) %>%
  summarise(N = n())

table_data2


```

Using this `table` class object `table_data`, we obtain a pie chart.

```{r}
ggplot(data = table_data, aes(x="", y=n, fill=Class)) +
  geom_col() +
  geom_text(aes(label = n), position = position_stack(vjust = 0.5)) + 
  coord_polar(theta="y") +
  theme_void()

# or simply 
ggplot(data = table_data, aes(x="", y=n, fill=Class)) +
  geom_col() + 
  coord_polar(theta="y") +
  theme_void()


# using table_data2
ggplot(data = table_data2, aes(x="", y=N, fill=Class)) +
  geom_col() + 
  coord_polar(theta="y") +
  theme_void()
```
